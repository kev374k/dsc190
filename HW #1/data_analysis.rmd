---
title: "Impact of Maternal Smoking on Infant Birthweight"
author: "Author 1 and Author 2"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Header

## Author Contributions
Brief description of the respective contribution of each team member.

Author 1: Worked on questions #1, #3, and #5, and created the data analysis template for the homework. Additionally, Author 1 worked on the advanced analysis question, creating the visualization for the problem and describing it.

Author 2:

## Use of GPT
ChatGPT was used as a substitute for documentation for R. Since we were unfamiliar with R, we asked ChatGPT how to use R in certain methods in order to find and filter out conditions in the dataset. We additionally used GPT to analyze reasoning and to confirm what we thought was correct about the dataset, as well as to identify extra questions that could be answered for our advanced analysis.

# Introduction

The data provided is a Child Health and Development Studies dataset, which consisted of all pregnancies that occurred from 1960-1967 among women with the **Kaiser Health Plan** in Oakland, CA. Some important things to note are that all 1236 babies in the dataset are boys, there are no twins, and all lived at least 28 days. It's important to keep in mind that this is not classified as a simple random sample of all pregnancies, because the conditions just posed cannot be proven to be a totally random sample of all babies born to mothers. However, we are still studying this data beause it still should be a decent representation of differences in weight between babies born to mothers who smoked during pregnancy and those who didn't, even if it is not totally representative of all babies. 

## Main Research Questions

1. What are the numerical distributions of the birth weight for babies born to women who smoked versus those who didn't smoke?
2. Is there a significant difference in these two distributions? If so, what type of conclusion can be reached?
3. What percentage of babies born between these two groups (non-smoking mothers and smoking mothers) are considered low-birth-weight babies? Is there a difference?
4. How does the reliability of the three types of comparisons - numerical, graphical, and incidence - change based on our data, and which was the best?

## Outline

The remainder of the report will go through a basic analysis of the data, including our cleaning methods, basic analysis on various variables in the study, and more. Additionally, we will analysis the questions posed above, along with the conclusions that we came up with in our data. We will also pose an advanced analysis question based on the relationship between the gestation period of a pregnancy and see how the relationship between a child's birthweight and their mother's smoking-status are intertwined.

# Basic Analysis

## Data Processing and Summaries

### Methods

```{r}
data <- read.table("babies.txt", header = TRUE)

summary(data)

bwt_description <- summary(data$bwt)
bwt_description

gestation_description <- summary(data$gestation)
gestation_description

parity_description <- summary(data$parity)
parity_description

age_description <- summary(data$age)
age_description

height_description <- summary(data$height)
height_description

weight_description <- summary(data$weight)
weight_description

smoke_description <- summary(data$smoke)
smoke_description
```

```{r, fig.width = 3, fig.height = 3, fig.ncol = 2, echo = FALSE}
hist(data$bwt, main = "Birthweight", xlab = "Birthweight (oz)", col = "lightblue")
hist(data$gestation, main = "Gestation", xlab = "Gestation (days)", col = "red")
hist(data$parity, main = "Parity", xlab = "Parity (0 = First Pregnancy)", col = "lightgreen")
hist(data$age, main = "Mother's Age", xlab = "Age (years)", col = "lightgrey")
hist(data$height, main = "Mother's Height", xlab = "Height (inches)", col = "lightpink")
hist(data$weight, main = "Mother's Weight", xlab = "Weight (lbs)", col = "lightgreen")
hist(data$smoke, main = "Smoking Status", xlab = "Smoker (0 = No)", col = "lightblue")
```

```{r}
cleaned_df <- data[data$gestation < 500 & data$age < 50 & data$height < 80 & data$weight < 500 & data$smoke <= 1, ]
head(cleaned_df, 5)
```

### Analysis

```{r data-summary}
# Your R code for data summary
```

### Conclusions

Your conclusions about data processing and summaries.

## Question 1 (rename)

### Methods

```{r q1-methods}
# Your R code for methods related to Question 1
```

### Analysis

```{r q1-analysis}
# Your R code for analysis related to Question 1
```

### Conclusions

Your conclusions for Question 1.

## Question 2 (rename)

### Methods

```{r q2-methods}
# Your R code for methods related to Question 2
```

### Analysis

```{r q2-analysis}
# Your R code for analysis related to Question 2
```

### Conclusions

Your conclusions for Question 2.

## Question 3 (rename)

### Methods

```{r q3-methods}
# Your R code for methods related to Question 3
```

### Analysis

```{r q3-analysis}
# Your R code for analysis related to Question 3
```

### Conclusions

Your conclusions for Question 3.

## Question 4 (rename)

### Methods

```{r q4-methods}
# Your R code for methods related to Question 4
```

### Analysis

```{r q4-analysis}
# Your R code for analysis related to Question 4
```

### Conclusions

Your conclusions for Question 4.

# Advanced Analysis

## Additional Research Question

How does smoking's impact on a baby's birth weight vary depending on how long the pregnancy last? 

### Methods

The method we used to analyze the relationship between one of the other variables in the dataset, "gestation", and the babies' weights and parents' smoking status was by using a scatterplot. For starters, we wanted to visually see if there was a relationship between the gestation period and the birth weight, so we used these as our x and y-axes, respectively. In order to identify the difference smoking mothers and non-smoking mothers, we realized that since it was a categorical variable, we could color the dots to indicate it's status. Additionally, we also created a regression line for each subset of mothers, so we could see if a mother's smoking status could visually be represented differently on the plot itself. 

```{r advanced-analysis, echo = FALSE}
plot(cleaned_df$gestation, cleaned_df$bwt, 
     col = ifelse(cleaned_df$smoke == 1, "red", "blue"),
     pch = 19, 
     xlab = "Gestation (days)", 
     ylab = "Birth Weight (oz)",
     main = "Birth Weight vs. Gestation by Smoking Status",
     cex = 0.5)

smoke_1 <- subset(cleaned_df, smoke == 1)
smoke_0 <- subset(cleaned_df, smoke == 0)

abline(lm(bwt ~ gestation, data = smoke_1), col = "red", lwd = 2)
abline(lm(bwt ~ gestation, data = smoke_0), col = "blue", lwd = 2)


legend("topleft", legend = c("Smokers", "Non-smokers"), col = c("red", "blue"), pch = 19)
```


### Analysis

As a general trend, both smokers and non-smokers show a positive correlation between gestation and birth-weight, indicating that the longer a gestation period is, the baby's birth weight typically increases. 

We also see that the two regression lines (for smoking moms and non-smoking moms) have different slopes. It's shown that the line associated with the smoking moms has a steeper slope than than the line associated with non-smoking mothers. This suggests that for smokers, birth weight increases more rapidly with longer gestation periods for smokers. 

We can also notice that over the same gestation periods, babies born to smokers tend to have lower birth weights than their respective counterparts, as observed by the fact that the red line is consistently lower than the blue line for most of the gestation period. 

Another thing that can be noticed is the variability of the gestation periods, specifically for non-smoking mothers. Looking through the data, gestation periods for mothers ranged from 150-350 days, while smoking mothers had a much smaller range, typically falling from a range of 220-330 days. 

Finally, the last thing to notice from this graph is that there are significantly less mothers that smoke than those that did not. 

### Conclusions

Through this graph, a few conclusions can be reached:

- Smoking is correlated with lower birth weight. The data shows a clear distinction between smokers and non-smokers in terms of their child's birth weight. Since the red line consistenly falls below that of the blue line for most gestation periods, it implies that on average, smoking is associated with lower birth weights.
- Gestation length is positively correlated with birth weight. This means that the longer a gestation period is, the higher the birth weight of a baby usually is.
- Non-smokers show a slower increase in birth weight compared to smokers. There can be many speculations about this, but looking at this graph, it seems that smokers typically have lower birth weights in the same gestation period as non-smokers, leading to their line needing to start at a lower area and climb back up to catch up to other babies that . This could also potentially mean that non-smokers typically have as much of a deviation of a child's birth weight as smokers do, since their slope is smaller, with many of their birth weights being concentrated, while children of smoking mother's have more variability in terms of their birth weight.

# Conclusions and Discussion

## Summary of Findings

Reprise the questions and goals of the analysis stated in the introduction. Summarize the findings and compare them to the original goals.

## Discussion

Additional observations or details gleaned from the analysis section. Discuss relevance to the science and other studies, if applicable. Address data limitations. Raise new questions and suggest future work.

# Appendix

Include any additional technical details, tables, or figures that support your analysis but would disrupt the flow of the main text if included earlier.

```{r appendix-code, eval=FALSE}
# Additional R code or output can be included here
```